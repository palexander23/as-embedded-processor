# Application Software

# This code defines the software defined in the pseudocode in the project spec.
# The overall functionality is to read two numbers from the switches on the FPGA 
# and multiply them together.
# 
# A handshaking protocol is implemented using SW[8] one of the switches and the 
# result of the output is displayed on the FPGA LEDs, routed from the ALU output.

# Load x1 into %2
BEQ  %1 %0 0            # Wait while SW[8] == 0
ACCI %2 %0 0            # Read SW[7:0] into %2

# Load y1 into %3
BNE  %1 %0 0            # Wait while SW[8] != 0
BEQ  %1 %0 0            # Wait while SW[8] == 0
ACCI %3 %1 0            # Read SW[7:0] into %3

BNE  %1 %0 0            # Wait while SW[8] != 0

# Compute y2
ACCI %0 %1 12           # Load b2 into ACC
MACI %0 %2 b11000000    # Add a21*x1 to ACC
MACI %4 %3 b01100000    # Add a22*y1 to ACC to give y2. Save to %3

# Compute x2
ACCI %0 %1 5            # Set ACC to 5
MACI %0 %2 b01100000    # Add a11*x1 to ACC
MACI %0 %3 b01000000    # Add a12*y1 to ACC to give x2. Save to %4

# Display x2
BEQ  %1 %0 0            # Wait for SW[8] to become 1

ACCI %4 %1 0            # Write y2 to ACC for dislpay
BNE  %1 %0 0            # Wait for SW[8] to go to 0 

# Loop back to start 
BEQ %0 %0 -15
